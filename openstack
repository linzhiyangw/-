openstack 是由NASA(美国国家航空航天局)和Rackspace合作研发并发的项目
openstack是一套Iaas 解决方案,是一个开源的云计算管理平台,以apache许可证为授权

七大组件
horizon 用于管理openstack各种服务的,基于web的管理接口,通过图形界面实现创建用户,管理网络,启动实例等操作
keystone 为其他服务提供认证和授权的集中身份管理服务,支持多种身份认证模式,如密码认证,令牌认证,以及AWS(亚马逊web服务)登录
neutron 定义网络服务,用于创建网络,子网,路由器,管理浮动ip地址,可以实现虚拟交换机,虚拟路由器,可用于在项目中创建vpn
cinder  为虚拟机管理存储卷的服务,为运行在nova中的实例提供永久的块存储
glance  扮演虚拟机镜像注册角色,允许用户为直接存储拷贝服务器镜像
nova 在节点上用于管理虚拟机服务,nova是一个分布式的服务,能够与keystone交互实现认证,与glance交互实现镜像管理,nova被设计成在标准硬件上能够进行水平扩展

openstack主机安装的包
yum -y install qemu-kvm libvirt-client livirt-daemon libvirt-daemon-driver-qemu python-setuptools
起服务 设开启自起 libvartd

nova01 nova02 安装  yum -y install qemu-kvm libvirt-client livirt-daemon libvirt-daemon-driver-qemu
起服务 设开启自起 libvartd

查看是否卸载firewalld和networkmanager
rpm -qa | grep -i firewalld
rpm -qa | grep -i networkmanager

检查ip (必须是静态ip)
[root@openstack ~]# cat /etc/sysconfig/network-scripts/ifcfg-eth0 

检查主机名映射
cat /etc/hosts

查看yum源  repolist: 10,670   包数正确

NTP时间服务器正常   chronyc sources -v   ^* gateway (*正确)

查看DNS
[root@openstack ~]# cat /etc/resolv.conf 
; generated by /usr/sbin/dhclient-script
nameserver 192.168.1.254

准备完成后

openstack主机安装  openstack-packstack 
生成应答文件
packstack --gen-answer-file=answer.ini
修改配置文件
vim answer.ini
42 CONFIG_SWIFT_INSTALL=n
45 CONFIG_CEILOMETER_INSTALL=n
49 CONFIG_AODH_INSTALL=n
53 CONFIG_GNOCCHI_INSTALL=n
75 CONFIG_NTP_SERVERS=192.168.1.254 #时间服务启
98 CONFIG_COMPUTE_HOSTS=192.168.1.11 #nova01
102 CONFIG_NETWORK_HOSTS=192.168.1.10,192.168.1.11
333 CONFIG_KEYSTONE_ADMIN_PW=v #管理员的密码
840 CONFIG_NEUTRON_ML2_TYPE_DRIVERS=flat,vxlan  #支持的网络协议flat扁平网络协议 vlan局域网
910 CONFIG_NEUTRON_OVS_BRIDGE_MAPPINGS=physnet1:br-ex 定义虚拟交换机
921 CONFIG_NEUTRON_OVS_BRIDGE_IFACES=br-ex:eth0 虚拟交换机转发给网卡      再转发给外网通讯
1179 CONFIG_PROVISION_DEMO=n 关闭例子

packstack --answer-file=answer.ini


yum源
[local_repo]
name=CentOS-$releasever - Base
baseurl="ftp://192.168.1.254/centos-1804"
enabled=1
gpgcheck=0

[extras]
name=extras
baseurl="ftp://192.168.1.254/extras"
enabled=1
gpgcheck=0

[openstack]
name=openstack
baseurl="ftp://192.168.1.254/openstack/rhel-7-server-openstack-10-devtools-rpms"
enabled=1
gpgcheck=0

[openstack-dev-tools]
name=openstack-dev-tools
baseurl="ftp://192.168.1.254/openstack/rhel-7-server-openstack-10-rpms"
enabled=1
gpgcheck=0

主机名映射
192.168.1.10 openstack
192.168.1.11 nova01
192.168.1.12 nova02


验证
查看外部ovs网桥
cat /etc/sysconfig/network-scripts/ifcfg-br-ex

eth0为外部ovs网桥的端口
cat /etc/sysconfig/network-scripts/ifcfg-eth0

验证ovs配置
ovs-vsctl show 

horizon BUG处理
/etc/httpd/conf.d/15-horizon_vhost.conf
添加  WGIApplicationGroup %{GLOBAL}
systemctl  reload httpd  重新载入配置文件

openstack 破解密码


openstack user set --password 密码用户

cat /etc/keystone/keystone.conf 查看生成令牌  18行



















































